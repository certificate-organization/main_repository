<html layout:decorate="~{layout}">
<div layout:fragment="content" class="container my-3">
    <h1 th:text="${article.subject}"></h1>
    <div th:text="${article.content}"></div>

    <h2 th:text="|{#list.size(article.commentList)}개의 답변이 있습니다.|"></h2>
    <div>
        <ul>
            <li th:each="comment : ${article.commentList}" th:text="${comment.content}"></li>
            <div class="my-3">
                <a th:href="@{|/comment/modify/${comment.id}|}" class="btn btn-sm btn-outline-secondary"
                   sec:authorize="isAuthenticated()"
                   th:if="${comment.author != null and #authentication.getPrincipal().getUsername() == comment.author.membername}"
                   th:text="수정"></a>
            </div>
            <div class="my-3">
                <a th:href="@{|/comment/delete/${comment.id}|}" class="delete btn btn-sm btn-outline-secondary"
                   sec:authorize="isAuthenticated()"
                   th:if="${comment.author != null and #authentication.getPrincipal().getUsername() == comment.author.membername}"
                   th:text="삭제"></a>
            </div>
        </ul>
    </div>

    <form action="th:@{|comment/create/${article.id}|}" th:object="${commentForm}" method="post">
        <div class="alert alert-danger" role="alert" th:if="${#fields.hasAnyErrors()}">
            <div th:each="err : ${#fields.allErrors()}" th:text="${err}"/>
        </div>
        <textarea sec:authorize="isAnonymous()" disabled th:field="*{content}" class="form-control" rows="10"></textarea>
        <textarea sec:authorize="isAuthenticated()" th:field="*{content}" class="form-control" rows="10"></textarea>
        <input type="submit" value="등록하기">
    </form>
</div>
</html>