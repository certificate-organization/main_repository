<html layout:decorate="~{layout}">
<div layout:fragment="content" class="container my-3">
    <div class="col-6">

        <div class="TOP">
            <div class="logo">
                <a class="article-logo" th:href="@{|/mbti/${mbti.id}|}" th:text="|${mbti.name} 게시판|"></a>
            </div>
            <a th:if="${member != null and member.mbti.id == mbti.id}"
               sec:authorize="isAuthenticated()"
               th:href="@{|/mbti/${mbti.id}/article/create|}" class="create-btn">글쓰기</a>
        </div>
    </div>
    <div class="article-table">
        <table class="article-list">
            <thead class="article-list-head">
            <tr>
                <th style="width=10%">번호</th>
                <th class="article-list-subject-head">제목</th>
                <th style="width=10%">작성자</th>
                <th style="width=10%">작성일</th>
                <th style="width=10%">조회수</th>
                <th style="width=10%">추천수</th>
            </tr>
            </thead>
            <tbody>
            <tr class="article-list-body" th:each="article, loop : ${articlePage}">
                <th th:text="${articlePage.getTotalElements - (articlePage.number * articlePage.size) - loop.index}"></th>
                <td class="article-list-subject-body">
                    <a class="article-list-subject" th:href="@{|/article/${article.id}|}"
                       th:text="${article.subject}">
                    </a>
                    <span th:if="${#lists.size(article.likers) != 0}"
                          class="article-comment" th:text="|[${#lists.size(article.likers)}]|"></span>
                </td>
                <td>
                    <a class="article-list-author" href="#"
                       th:text="|${article.author.membername}[${article.author.mbti.name}]|"></a>
                </td>
                <td style="width: 8%" th:id="|result${loop.index + 1}|"></td>
                <td style="width: 6%" th:text="${article.viewCount}"></td>
                <td style="width: 6%" th:text="${#lists.size(article.likers)}|"></td>
                <script th:src="@{/calculateDate.js}"></script>
                <script th:inline="javascript">
                    calculateDate (/*[[${article.createDate}]]*/ '', 'result' + /*[[${loop.index + 1}]]*/);
                </script>
            </tr>
            </tbody>
        </table>
    </div>

    <div th:if="${!articlePage.isEmpty()}">
        <ul class="article-paging">
            <li th:if="${articlePage.hasPrevious()}">
                <a class="article-page" th:href="@{|?keyword=${keyword}&page=${articlePage.number-1}|}"
                   aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            <li th:if="${page <= articlePage.number+10}"
                th:each="page: ${#numbers.sequence(0, articlePage.totalPages-1)}">
                <a class="article-page" th:classappend="${page == articlePage.number} ? 'active-page'"
                   th:href="@{|?keyword=${keyword}&page=${page}|}"
                   th:text="${page+1}"></a>
            </li>
            <li th:if="${articlePage.hasNext}">
                <a class="article-page" th:href="@{|?keyword=${keyword}&page=${articlePage.number+1}|}"
                   aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </div>

    <div class="article-table" th:if="${!articlePage.isEmpty()}">
        <form th:action="@{|/mbti/${mbti.id}|}" method="get" class="search-box">
            <div class="search-box-inner">
                <input class="search-txt" type="text"
                       name="keyword" th:value="${keyword}" placeholder="검색어를 입력하세요.">
                <button class="search-btn" type="submit">
                    <i class="fa fa-search fa-magnifying-glass"></i>
                </button>
            </div>
        </form>
    </div>

    <form th:action="@{|/mbti/${mbti.id}|}" method="get">
        <input type="hidden" name="keyword" th:value="${keyword}">
        <input type="hidden" name="page" th:value="${articlePage.number}">
    </form>


</div>
</html>