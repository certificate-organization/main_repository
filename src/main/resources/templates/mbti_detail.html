<html lang="ko" layout:decorate="~{layout}">
<div layout:fragment="content" class="article-container">
    <!-- 게시판 상단 start -->
    <div class="col-6">
        <div class="wrap">
            <div class="dark_mode">
                <div class="inner">
                    <input type="radio" name="toggle" id="toggle_light" checked><label for="toggle_light"
                                                                                       class="light_icon"><i
                        class="fas fa-sun light_icon"></i></label>
                    <input type="radio" name="toggle" id="toggle_dark"><label for="toggle_dark" class="dark_icon"><i
                        class="fas fa-moon dark_icon"></i></label>
                    <div class="dark_mode-bg"></div>
                </div>
            </div>
        </div>
        <div class="TOP">
            <div class="logo">
                <a class="article-logo" th:href="@{|/mbti/${mbti.id}|}" th:text="|${mbti.name} 게시판|"></a>
            </div>
            <a th:if="${member != null and member.mbti.id == mbti.id}"
               sec:authorize="isAuthenticated()"
               th:href="@{|/mbti/${mbti.id}/article/create|}" class="create-btn">글쓰기</a>
        </div>
    </div>
    <!-- 게시판 상단 end -->
    <!-- mbti 정보 start -->
    <div style="display: flex; align-items: center;">
        <div style="display: flex; flex-direction: column; margin-right: 15px; margin-left: 20px;">
            <div class="mbti-elements">
                <div class="mbti-element" th:each="element : ${mbti.elements}">
                    <span style="font-family: 'Poor Story', system-ui;" class="mbti-element-text"
                          th:text="${element}"></span>
                </div>
            </div>
            <div style="display: flex; height: 200px; width: 550px; justify-content: flex-end; flex-direction: column; align-items: center;">
                <img src="https://www.16personalities.com/static/images/personality-types/headers/sentinels_Logistician_ISTJ_personality_header.svg"
                     alt="ISTJ" th:if="${mbti.name == 'ISTJ'}">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'ISTJ'}">
                    현실주의자📊
                </div>

                <img src="https://www.16personalities.com/static/images/personality-types/headers/explorers_Virtuoso_ISTP_personality_header.svg"
                     alt="ISTP" th:if="${mbti.name == 'ISTP'}">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'ISTP'}">
                    장인🛠️
                </div>

                <img src="https://www.16personalities.com/static/images/personality-types/headers/sentinels_Defender_ISFJ_personality_header.svg"
                     alt="ISFJ" th:if="${mbti.name == 'ISFJ'}">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'ISFJ'}">
                    수호자💉
                </div>

                <img src="https://www.16personalities.com/static/images/personality-types/headers/explorers_Adventurer_ISFP_personality_header.svg"
                     alt="ISFP" th:if="${mbti.name == 'ISFP'}">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'ISFP'}">
                    모험가🎨
                </div>

                <img src="https://www.16personalities.com/static/images/personality-types/headers/analysts_Architect_INTJ_personality_header.svg"
                     alt="INTJ" th:if="${mbti.name == 'INTJ'}" style="width: 520px; margin-right: 30px;">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'INTJ'}">
                    전략가🚩
                </div>

                <img src="https://www.16personalities.com/static/images/personality-types/headers/analysts_Logician_INTP_personality_header.svg"
                     alt="INTP" th:if="${mbti.name == 'INTP'}">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'INTP'}">
                    논리술사🧪
                </div>

                <img src="https://www.16personalities.com/static/images/personality-types/headers/diplomats_Advocate_INFJ_personality_header.svg"
                     alt="INFJ" th:if="${mbti.name == 'INFJ'}">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'INFJ'}">
                    옹호자🌳
                </div>

                <img src="https://www.16personalities.com/static/images/personality-types/headers/diplomats_Mediator_INFP_personality_header.svg"
                     alt="INFP" th:if="${mbti.name == 'INFP'}">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'INFP'}">
                    중재자🌸
                </div>

                <img src="https://www.16personalities.com/static/images/personality-types/headers/sentinels_Executive_ESTJ_personality_header.svg"
                     alt="ESTJ" th:if="${mbti.name == 'ESTJ'}">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'ESTJ'}">
                    경영자👔
                </div>

                <img src="https://www.16personalities.com/static/images/personality-types/headers/explorers_Entrepreneur_ESTP_personality_header.svg"
                     alt="ESTP" th:if="${mbti.name == 'ESTP'}">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'ESTP'}">
                    사업가🕶️
                </div>

                <img src="https://www.16personalities.com/static/images/personality-types/headers/sentinels_Consul_ESFJ_personality_header.svg"
                     alt="ESFJ" th:if="${mbti.name == 'ESFJ'}">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'ESFJ'}">
                    집정관🎂
                </div>

                <img src="https://www.16personalities.com/static/images/personality-types/headers/explorers_Entertainer_ESFP_personality_header.svg"
                     alt="ESFP" th:if="${mbti.name == 'ESFP'}">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'ESFP'}">
                    연예인🌟
                </div>

                <img src="https://www.16personalities.com/static/images/personality-types/headers/analysts_Commander_ENTJ_personality_header.svg"
                     alt="ENTJ" th:if="${mbti.name == 'ENTJ'}">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'ENTJ'}">
                    통솔자🪖
                </div>

                <img src="https://www.16personalities.com/static/images/personality-types/headers/analysts_Debater_ENTP_personality_header.svg"
                     alt="ENTP" th:if="${mbti.name == 'ENTP'}">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'ENTP'}">
                    변론가🗣️
                </div>

                <img src="https://www.16personalities.com/static/images/personality-types/headers/diplomats_Protagonist_ENFJ_personality_header.svg"
                     alt="ENFJ" th:if="${mbti.name == 'ENFJ'}">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'ENFJ'}">
                    선도자⚔️
                </div>

                <img src="https://www.16personalities.com/static/images/personality-types/headers/diplomats_Campaigner_ENFP_personality_header.svg"
                     alt="ENFP" th:if="${mbti.name == 'ENFP'}">
                <div style="font-family: 'Poor Story', system-ui; font-size: large;" th:if="${mbti.name == 'ENFP'}">
                    활동가🧗‍♀️
                </div>
            </div>
        </div>
        <div class="mbti-information">

            <!-- tab메뉴 start -->
            <div class="tab-container" style="flex-direction: column;">
                <div class="d-flex align-items-start" style="margin-top: 10px;">
                    <div class="nav flex-column nav-pills me-3" id="v-pills-tab" role="tablist"
                         aria-orientation="vertical"
                         style="display: flex; align-items: center; justify-content: space-around; margin-left: 10px; ">

                        <button class="nav-link" id="v-pills-profile-tab" data-bs-toggle="pill"
                                data-bs-target="#v-pills-profile" type="button" role="tab"
                                aria-controls="v-pills-profile" aria-selected="false"
                                style="border-radius: 20px; margin-bottom: 5px; font-family: 'Poor Story', system-ui;
                                font-weight: bold; display: flex; align-items: center; width: 92px; justify-content: center;">성격
                            <i class="fa-solid fa-face-smile" style="margin-left: 3px;"></i>
                        </button>
                        <button class="nav-link active" id="v-pills-home-tab" data-bs-toggle="pill"
                                data-bs-target="#v-pills-home" type="button" role="tab" aria-controls="v-pills-home"
                                aria-selected="true" style="border-radius: 20px; margin-bottom: 5px; width: 92px; justify-content: center;
                                 font-family: 'Poor Story', system-ui; font-weight: bold; display: flex; align-items: center;">연애
                            <i class="fa-solid fa-heart-pulse" style="margin-left: 3px;"></i>
                        </button>
                        <button class="nav-link" id="v-pills-disabled-tab" data-bs-toggle="pill"
                                data-bs-target="#v-pills-disabled" type="button" role="tab"
                                aria-controls="v-pills-disabled"
                                aria-selected="false" style="border-radius: 20px; margin-bottom: 5px; width: 92px; justify-content: center;
                                font-family: 'Poor Story', system-ui; font-weight: bold; display: flex; align-items: center;">유명인
                            <i class="fa-solid fa-star" style="margin-left: 3px;"></i>
                        </button>
                        <button class="nav-link" id="v-pills-messages-tab" data-bs-toggle="pill"
                                data-bs-target="#v-pills-messages" type="button" role="tab"
                                aria-controls="v-pills-messages"
                                aria-selected="false" style="border-radius: 20px; margin-bottom: 5px; width: 92px; justify-content: center;
                                font-family: 'Poor Story', system-ui; font-weight: bold; display: flex; align-items: center;">직업
                            <i class="fa-solid fa-briefcase" style="margin-left: 3px;"></i>
                        </button>
                    </div>
                    <div class="tab-content" id="v-pills-tabContent" style="margin-left: 20px;">
                        <div th:if="${mbti.relationship != null}" class="tab-pane fade" id="v-pills-profile"
                             role="tabpanel" style="max-height: 200px; overflow-y: auto;"
                             aria-labelledby="v-pills-profile-tab" tabindex="0"
                             th:utext="${@commonUtil.markdown(mbti.relationship)}">
                        </div>
                        <div th:if="${mbti.love != null}" class="tab-pane fade show active" id="v-pills-home"
                             role="tabpanel" style="max-height: 200px; overflow-y: auto;"
                             aria-labelledby="v-pills-home-tab" tabindex="0"
                             th:utext="${@commonUtil.markdown(mbti.love)}">
                        </div>

                        <div th:if="${mbti.celebrity != null}" class="tab-pane fade" id="v-pills-disabled"
                             role="tabpanel" style="max-height: 200px; overflow-y: auto;"
                             aria-labelledby="v-pills-disabled-tab" tabindex="0"
                             th:utext="${@commonUtil.markdown(mbti.celebrity)}">
                        </div>
                        <div th:if="${mbti.job != null}" class="tab-pane fade" id="v-pills-messages" role="tabpanel"
                             aria-labelledby="v-pills-messages-tab" tabindex="0" style="max-height: 200px; overflow-y: auto;"
                             th:utext="${@commonUtil.markdown(mbti.job)}">
                        </div>
                    </div>
                </div>

            </div>

        </div>

    </div>
    <!-- tab메뉴 end -->
    <div class="information-btn">
        <a th:if="${member != null and #authentication.getPrincipal().getUsername() == 'admin'}"
           sec:authorize="isAuthenticated()"
           th:href="@{/mbti/information}" class="back-btn">수정</a>
    </div>
    <!-- mbti 정보 end -->
    <!-- 게시글 start -->
    <div class="article-table">
        <table class="article-list">
            <thead class="article-list-head">
            <tr>
                <th>번호</th>
                <th class="article-list-subject-head">제목</th>
                <th>작성자</th>
                <th>작성일</th>
                <th>조회수</th>
                <th>추천수</th>
            </tr>
            </thead>
            <tbody>
            <tr class="article-list-body" th:each="article, loop : ${articlePage}">
                <th th:text="${articlePage.getTotalElements - (articlePage.number * articlePage.size) - loop.index}"></th>
                <td class="article-list-subject-body"
                    style="display: flex; justify-content: flex-start; align-items: center; margin-top: 4px; width: 500px;">
                    <i class="fa-solid fa-image" th:if="${article.articleImg != null}"></i>
                    <i class="fa-solid fa-comment-dots" th:if="${article.articleImg == null}"></i>
                    <a class="article-list-subject" th:href="@{|/article/${article.id}|}"
                       th:text="${article.subject}">
                    </a>
                    <span th:if="${#lists.size(article.commentList) != 0}"
                          class="article-comment" th:text="|[${#lists.size(article.commentList)}]|"></span>
                </td>
                <td>
                    <a class="article-list-author" th:href="@{|/member/info/${article.author.nickname}|}"
                       th:text="|${article.author.nickname}[${article.author.mbti.name}]|"></a>
                </td>
                <td style="width: 8%" th:id="|result${loop.index + 1}|"></td>
                <td style="width: 6%" th:text="${article.viewCount}"></td>
                <td style="width: 6%" th:text="${#lists.size(article.likers)}|"></td>
                <script th:src="@{/js/calculateDate.js}"></script>
                <script th:inline="javascript">
                    calculateDate (/*[[${article.createDate}]]*/, 'result' + /*[[${loop.index + 1}]]*/);
                </script>
            </tr>
            </tbody>
        </table>
    </div>
    <!-- 게시글 end -->
    <!-- 페이징 start -->
    <div th:if="${!articlePage.isEmpty()}">
        <ul class="article-paging">
            <li th:if="${articlePage.hasPrevious()}">
                <a class="article-page" th:href="@{|?keyword=${keyword}&page=${articlePage.number-1}|}"
                   aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            <li th:if="${page <= articlePage.number+10}"
                th:each="page: ${#numbers.sequence(0, articlePage.totalPages-1)}">
                <a class="article-page" th:classappend="${page == articlePage.number} ? 'active-page'"
                   th:href="@{|?keyword=${keyword}&page=${page}|}"
                   th:text="${page+1}"></a>
            </li>
            <li th:if="${articlePage.hasNext}">
                <a class="article-page" th:href="@{|?keyword=${keyword}&page=${articlePage.number+1}|}"
                   aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </div>
    <!-- 페이징 end -->
    <!-- 검색 start -->
    <div class="article-table" th:if="${!articlePage.isEmpty()}">
        <form th:action="@{|/mbti/${mbti.id}|}" method="get" class="search-box">
            <div class="search-box-inner">
                <input class="search-txt" type="text"
                       name="keyword" th:value="${keyword}" placeholder="검색어를 입력하세요.">
                <button class="search-btn" type="submit">
                    <i class="fa fa-search fa-magnifying-glass"></i>
                </button>
            </div>
        </form>
    </div>
    <!-- 검색 end -->
    <!-- 검색기능 start -->
    <form th:action="@{|/mbti/${mbti.id}|}" method="get">
        <input type="hidden" name="keyword" th:value="${keyword}">
        <input type="hidden" name="page" th:value="${articlePage.number}">
    </form>
    <!-- 검색기능 end -->
</div>
</html>